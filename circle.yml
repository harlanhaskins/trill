machine:
  xcode:
    version: 9.0
  environment:
    LC_CTYPE: en_US.UTF-8
    PATH: /usr/local/opt/llvm/bin:$PATH

dependencies:
  override:
    - brew update
    - brew install llvm cmake pkg-config
    - pip install pkgconfig
    - pip install git+https://github.com/kronenthaler/mod-pbxproj.git@python3-support
    - git clone https://github.com/trill-lang/LLVMSwift.git /tmp/LLVMSwift
    - swift /tmp/LLVMSwift/utils/make-pkgconfig.swift
    - git clone https://github.com/trill-lang/ClangSwift.git /tmp/ClangSwift
    - swift /tmp/ClangSwift/utils/make-pkgconfig.swift

test:
  override:
    - utils/build --test
